(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{141:function(e,t,n){"use strict";n.r(t);n(73),n(74);var a=n(7),r=n.n(a),i=n(52),o=n.n(i),s=(n(170),n(33),n(171)),u=n.n(s),l=(n(157),n(173)),c=n.n(l),p=n(0),d=n.n(p),h=n(174),g=n(154);t.default=function(){return d.a.createElement(g.a,null,d.a.createElement(E,null))};var f=function(){function e(e){var t=e.userId,n=e.accessToken;this.userId=t,this.accessToken=n}var t=e.prototype;return t.query=function(){var e=c()(u.a.mark(function e(t){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"bearer "+this.accessToken},body:JSON.stringify({query:t})});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),t.queryStaredRepoCount=function(){var e=c()(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query('{\n      user(login: "'+this.userId+'") {\n        starredRepositories(first: 2) {\n          totalCount\n        }\n      }\n    }');case 2:return t=e.sent,e.abrupt("return",t.data.user.starredRepositories.totalCount);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.getAllStarredRepo=function(){var e=c()(u.a.mark(function e(){var t,n,a,r,i,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queryStaredRepoCount();case 2:t=e.sent,n=[],a=100,r=null,i=0;case 7:if(!(i<=t/a)){e.next=16;break}return e.next=10,this.queryRepos(a,r);case 10:o=e.sent,n.push.apply(n,o),r=o[o.length-1].cursor;case 13:i++,e.next=7;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),t.queryRepos=function(){var e=c()(u.a.mark(function e(t,n){var a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=null===n?"":'after: "'+n+'",',e.next=3,this.query('{\n      user(login: "'+this.userId+'") {\n        starredRepositories(first: '+t+", "+a+" orderBy: {field: STARRED_AT, direction: DESC}) {\n          edges {\n            cursor\n            node {\n              id\n              name\n              description\n              nameWithOwner\n              owner {\n                login\n              }\n              url\n              primaryLanguage {\n                name\n              }\n              languages(first: 20) {\n                nodes {\n                  name\n                }\n              }  \n            }\n          }\n        }\n      }\n    }");case 3:return r=e.sent,e.abrupt("return",r.data.user.starredRepositories.edges.map(function(e){var t=e.node,n=e.cursor;return Object.assign({},t,{owner:t.owner.login,primaryLanguage:t.primaryLanguage?t.primaryLanguage.name:"",languages:t.languages.nodes.map(function(e){return e.name}),cursor:n})}));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),e}(),m=h.a.ul.withConfig({displayName:"ghmark__RepoList",componentId:"wqqgav-0"})(["list-style-type:none;margin:0;padding:0;"]),v=h.a.li.withConfig({displayName:"ghmark__RepoItem",componentId:"wqqgav-1"})(["margin:10px;padding:10px;background-color:#f0f0f0;border-radius:4px;"]),w=h.a.a.withConfig({displayName:"ghmark__RepoLink",componentId:"wqqgav-2"})([""]),y=h.a.p.withConfig({displayName:"ghmark__RepoDescription",componentId:"wqqgav-3"})([""]),b=h.a.span.withConfig({displayName:"ghmark__Tag",componentId:"wqqgav-4"})(["display:inline-block;font:0.8em sans-serif;color:black;border:1px solid gray;border-radius:3px;padding:2px 4px;margin:2px 4px;box-shadow:1px 2px 3px;"]),C=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={page:0,pageSize:10},n.onPreviousPage=n.onPreviousPage.bind(o()(o()(n))),n.onNextPage=n.onNextPage.bind(o()(o()(n))),n}r()(t,e);var n=t.prototype;return n.componentWillReceiveProps=function(e){this.props.repos!==e.repos&&this.setState({page:0})},n.renderRepo=function(e){return d.a.createElement(v,{key:e.id},d.a.createElement(w,{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.nameWithOwner),d.a.createElement(y,null,e.description),e.languages.map(function(e){return d.a.createElement(b,{key:e},e)}))},n.onPreviousPage=function(){this.setState({page:this.state.page-1})},n.onNextPage=function(){this.setState({page:this.state.page+1})},n.render=function(){var e=this.state,t=e.page,n=e.pageSize,a=this.props.repos.length,r=t*n,i=(t+1)*n,o=i>=a,s=Math.min(i,a),u=this.props.repos.slice(r,s);return d.a.createElement("div",null,d.a.createElement(m,null,u.map(this.renderRepo)),0===this.state.page?null:d.a.createElement("button",{onClick:this.onPreviousPage},"⏪"),d.a.createElement("span",null,"Page ",this.state.page+1),o?null:d.a.createElement("button",{onClick:this.onNextPage},"⏩"))},t}(d.a.Component),E=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={loggedIn:!1,credential:n.getDefaultCredential(),starredRepositories:[],filterLanguage:"",filteredRepos:[],pageSize:10,page:1},n.handleFilterLanguageChange=n.handleFilterLanguageChange.bind(o()(o()(n))),n.handleCredentialInputChange=n.handleCredentialInputChange.bind(o()(o()(n))),n.handleSubmit=n.handleSubmit.bind(o()(o()(n))),n.handleLogout=n.handleLogout.bind(o()(o()(n))),n}r()(t,e);var n=t.prototype;return n.getDefaultCredential=function(){return{userId:"",accessToken:""}},n.load=function(e){return JSON.parse(window.localStorage.getItem(e))},n.loadGithubData=function(){var e=c()(u.a.mark(function e(t){var n,a,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new f(t),e.next=3,n.getAllStarredRepo();case 3:a=e.sent,r=this.filterRepoByLanguage(a,this.state.filterLanguage),this.setState({starredRepositories:a,filteredRepos:r});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.componentDidMount=function(){var e=this.load("credential");null!==e&&(this.setState({credential:e,loggedIn:!0}),this.loadGithubData(e))},n.save=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},n.delete=function(e){window.localStorage.removeItem(e)},n.handleSubmit=function(e){e.preventDefault();var t=this.state.credential;this.save("credential",t),this.setState({loggedIn:!0}),this.loadGithubData(t)},n.handleCredentialInputChange=function(e){var t,n=e.target,a=n.name,r=n.value,i=Object.assign({},this.state.credential,((t={})[a]=r,t));this.setState({credential:i})},n.handleFilterLanguageChange=function(e){var t=e.target.value,n=this.filterRepoByLanguage(this.state.starredRepositories,t);this.setState({filterLanguage:t,filteredRepos:n})},n.filterRepoByLanguage=function(e,t){return e.filter(function(e){var n=e.languages;return""===t||n.some(function(e){return e.toLowerCase().includes(t.toLowerCase())})})},n.renderLogin=function(){return d.a.createElement("form",{onSubmit:this.handleSubmit},d.a.createElement("label",null,"User ID:",d.a.createElement("input",{name:"userId",type:"text",value:this.state.credential.userId,onChange:this.handleCredentialInputChange})),d.a.createElement("label",null,"Access Token:",d.a.createElement("input",{name:"accessToken",type:"password",value:this.state.credential.accessToken,onChange:this.handleCredentialInputChange})),d.a.createElement("input",{type:"submit",value:"submit"}))},n.handleLogout=function(){this.delete("credential"),this.setState({credential:this.getDefaultCredential(),loggedIn:!1})},n.renderRepo=function(e){return d.a.createElement(v,{key:e.id},d.a.createElement(w,{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.nameWithOwner),d.a.createElement(y,null,e.description),e.languages.map(function(e){return d.a.createElement(b,{key:e},e)}))},n.renderList=function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement("h1",null,"Starred Repositories (",this.state.filteredRepos.length,")"),d.a.createElement("button",{onClick:this.handleLogout},"Log out"),d.a.createElement("label",null,"Filter By Language:",d.a.createElement("input",{name:"filterLanguage",type:"text",value:this.state.filterLanguage,onChange:this.handleFilterLanguageChange})),d.a.createElement(C,{repos:this.state.filteredRepos}))},n.render=function(){return this.state.loggedIn?this.renderList():this.renderLogin()},t}(d.a.Component)},154:function(e,t,n){"use strict";var a=n(7),r=n.n(a),i=n(0),o=n.n(i),s=n(16),u=(n(34),function(e){var t=window.location.href.indexOf("#");console.log(window.location.href.slice(0,t>=0?t:0)),window.location.replace(window.location.href.slice(0,t>=0?t:0)+"#"+e)}),l=function(e){var t,n;return{pathname:e||(t=window.location.href,-1===(n=t.indexOf("#"))?"":t.substring(n+1)),search:""}},c=function(){var e=l();return function(e){""===e.pathname&&u("/")}(e),{get location(){return l()},addEventListener:function(e,t){window.addEventListener(e,t)},removeEventListener:function(e,t){window.removeEventListener(e,t)},history:{state:e,pushState:function(t,n,a){var r;e=l(a),r=a,window.location.hash=r},replaceState:function(t,n,a){e=l(a),u(a)}}}},p=function(){return"undefined"!=typeof window},d=function(e){function t(t){var n;return n=e.call(this,t)||this,p()&&(n.history=Object(s.createHistory)(c())),console.log("app is initialized"),n}r()(t,e);var n=t.prototype;return n.render=function(){return p()?this.renderDynamic():this.renderStatic()},n.renderDynamic=function(){return o.a.createElement(s.LocationProvider,{history:this.history},this.props.children)},n.renderStatic=function(){return o.a.createElement("h1",null,"This app will only be rendered in browser.")},t}(o.a.Component);t.a=d}}]);
//# sourceMappingURL=component---src-pages-ghmark-js-9db38101a8bc39c41fe9.js.map